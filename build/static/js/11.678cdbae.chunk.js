(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[11],{1196:function(e,t,s){"use strict";s.r(t),s.d(t,"Rotation",(function(){return v}));var n=s(20),r=s(44),o=s(160),a=s(161),c=s(163),i=s(162),d=s(1),l=s(669),u=s(628),b=s.n(u),h=s(165),p=s(670),m=s(630),j=s(164),O=s(637),x=s(643),f=s(627),g=s(1193),C=s(1186),R="0",A=function(e){Object(c.a)(s,e);var t=Object(i.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).submitRotation=function(e){e.preventDefault(),n.generateDebtRotation(),n.props.handleClose()},n.generateDebtRotation=Object(m.a)(b.a.mark((function e(){var t,s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.eth.getAccounts();case 2:return t=e.sent,s=new O.a.eth.Contract(x.a,n.props.selectedCreditor.friendsAddress),r=new O.a.eth.Contract(x.a,n.props.selectedDebtor.friendsAddress),e.next=7,n.props.profile.methods.addDebtRotationRequestNotRestricted(n.props.mediatorAddress,n.props.selectedCreditor.friendsAddress,n.props.selectedDebtor.friendsAddress,n.state.amountToRotate,R,0).send({from:t[0],gas:"1000000"});case 7:return e.next=9,r.methods.addDebtRotationRequestNotRestricted(n.props.mediatorAddress,n.props.selectedCreditor.friendsAddress,n.props.selectedDebtor.friendsAddress,n.state.amountToRotate,R,0).send({from:t[0],gas:"1000000"});case 9:return e.next=11,s.methods.addDebtRotationRequestNotRestricted(n.props.mediatorAddress,n.props.selectedCreditor.friendsAddress,n.props.selectedDebtor.friendsAddress,n.state.amountToRotate,R,0).send({from:t[0],gas:"1000000"});case 11:case"end":return e.stop()}}),e)}))),n.state={amountToRotate:0,maxAmountToRotate:0},n.onChangeFormInput=n.onChangeFormInput.bind(Object(j.a)(n)),n.submitRotation=n.submitRotation.bind(Object(j.a)(n)),n.generateDebtRotation=n.generateDebtRotation.bind(Object(j.a)(n)),n}return Object(a.a)(s,[{key:"componentDidMount",value:function(){var e=parseInt(this.props.selectedCreditor.debt)>parseInt(this.props.selectedDebtor.debt)?parseInt(this.props.selectedDebtor.debt):parseInt(this.props.selectedCreditor.debt);this.setState({maxAmountToRotate:e})}},{key:"onChangeFormInput",value:function(e){e.preventDefault();var t=e.target,s=t.name,n=t.value;Number(n)&&(parseInt(n)>this.state.maxAmountToRotate?this.setState(Object(h.a)({},s,this.state.maxAmountToRotate)):this.setState(Object(h.a)({},s,n)))}},{key:"render",value:function(){return Object(n.jsx)("div",{children:Object(n.jsxs)(f.g,{children:[Object(n.jsx)(f.k,{style:{textAlign:"center"},children:"How Much to Rotate?"}),Object(n.jsx)(f.h,{children:Object(n.jsxs)(f.u,{action:"",method:"post",onSubmit:this.submitRotation,children:[Object(n.jsxs)(f.v,{children:[Object(n.jsxs)(f.M,{children:[Object(n.jsx)(f.D,{id:"amountDebt",name:"amountToRotate",placeholder:"Amount",autoComplete:"off",onChange:this.onChangeFormInput,required:!0,style:{textAlign:"center",maxWidth:"70%",paddingRight:"10%"}}),Object(n.jsxs)(f.w,{style:{paddingLeft:"5%",fontSize:"130%"},children:["/ ",this.state.maxAmountToRotate]})]}),0!==this.state.amountToRotate?Object(n.jsx)(f.M,{children:Object(n.jsxs)(f.w,{children:["transferring: ",this.state.amountToRotate]})}):""]}),Object(n.jsx)(f.v,{style:{textAlign:"center"},children:Object(n.jsx)(f.e,{type:"submit",size:"sm",color:"secondary",className:"confirm_button",disabled:!(this.state.amountToRotate>0),children:"Confirm"})})]})})]})})}}]),s}(d.Component),S=function(e){Object(c.a)(s,e);var t=Object(i.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).onCheckMyContracts=Object(m.a)(b.a.mark((function e(){var t,s,o,a,c,i,d,l,u,m,j,x,f;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n,e.next=3,n.props.profile.methods.getContracts().call();case 3:if(e.t1=e.sent,e.t2={contractsList:e.t1},e.t0.setState.call(e.t0,e.t2),!((t=n.state.contractsList.length)>0)){e.next=23;break}s=0;case 9:if(!(s<t)){e.next=23;break}return e.t3=n,e.t4=[],e.t5=Object(p.a)(n.state.allContracts),e.next=15,n.props.profile.methods.getContractsByIndex(s).call();case 15:e.t6=e.sent,e.t7=[e.t6],e.t8=e.t4.concat.call(e.t4,e.t5,e.t7),e.t9={allContracts:e.t8},e.t3.setState.call(e.t3,e.t9);case 20:s++,e.next=9;break;case 23:o=0,e.t10=b.a.keys(n.state.contractsList);case 25:if((e.t11=e.t10()).done){e.next=50;break}return o=e.t11.value,e.next=29,new O.a.eth.Contract(JSON.parse(n.props.compiledBinaryContract.interface),n.state.contractsList[o]);case 29:return a=e.sent,e.next=32,a.methods.getCurrentCreditorAddress().call();case 32:return c=e.sent,e.next=35,a.methods.getCurrentDebtorAddress().call();case 35:return i=e.sent,e.next=38,a.methods.getCurrentDebtAmount().call();case 38:return d=e.sent,l=void 0,void 0,u=void 0,c!==n.props.playerOne?(l=c,u="success"):(l=i,u="danger"),e.next=45,n.getNameFromAddress(l);case 45:m=e.sent,"danger"===(j={friendsAddress:l,debt:d,isInDebt:u,name:m}).isInDebt?(x=Object(r.a)(Object(r.a)({},n.state.peopleUserOwesTo),{},Object(h.a)({},o,j)),n.setState({peopleUserOwesTo:x})):(f=Object(r.a)(Object(r.a)({},n.state.peopleOweToUser),{},Object(h.a)({},o,j)),n.setState({peopleOweToUser:f})),e.next=25;break;case 50:case"end":return e.stop()}}),e)}))),n.getNameFromAddress=function(){var e=Object(m.a)(b.a.mark((function e(t){var s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new O.a.eth.Contract(x.a,t),e.next=3,s.methods.getName().call();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.debtorSelected=function(e){return function(t){n.setState({selectedDebtor:e}),n.setState((function(e){return{isDebtorSelected:!0}}))}},n.creditorSelected=function(e){return function(t){n.setState({selectedCreditor:e}),n.setState((function(e){return{isCreditorSelected:!0}}))}},n.handleOpenRotationSelectAmount=function(){n.setState({openRotationSelectAmount:!0})},n.handleCloseRotationSelectAmount=function(){n.setState({openRotationSelectAmount:!1})},n.state={contractsList:[],allContracts:[],listInformation:{},peopleUserOwesTo:{},peopleOweToUser:{},selectedDebtor:"",selectedCreditor:"",isDebtorSelected:!1,isCreditorSelected:!1,openRotationSelectAmount:!1,amountToRotate:0},n.debtorSelected=n.debtorSelected.bind(Object(j.a)(n)),n.creditorSelected=n.creditorSelected.bind(Object(j.a)(n)),n.handleOpenRotationSelectAmount=n.handleOpenRotationSelectAmount.bind(Object(j.a)(n)),n.handleCloseRotationSelectAmount=n.handleCloseRotationSelectAmount.bind(Object(j.a)(n)),n.getNameFromAddress=n.getNameFromAddress.bind(Object(j.a)(n)),n}return Object(a.a)(s,[{key:"componentDidMount",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof(t=window.ethereum)){e.next=4;break}return e.next=4,t.enable();case 4:this.onCheckMyContracts();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){for(var e=[],t=[],s=0,r=Object.entries(this.state.peopleOweToUser);s<r.length;s++){var o=Object(l.a)(r[s],2),a=o[0],c=o[1];e.push(Object(n.jsxs)(f.K,{accent:"success",color:"success",className:a===this.state.selectedDebtor?"selected group_item_padding":"group_item_padding",style:{borderTopWidth:"2px"},onClick:this.debtorSelected(a),children:[c.name,":",Object(n.jsx)("br",{})," ",Object(n.jsx)("b",{children:c.debt})]},a))}for(var i=0,d=Object.entries(this.state.peopleUserOwesTo);i<d.length;i++){var u=Object(l.a)(d[i],2),b=u[0],h=u[1];t.push(Object(n.jsxs)(f.K,{accent:"danger",color:"danger",className:b===this.state.selectedCreditor?"selected group_item_padding":"group_item_padding",style:{borderTopWidth:"2px"},onClick:this.creditorSelected(b),children:[h.name,":",Object(n.jsx)("br",{})," ",Object(n.jsx)("b",{children:h.debt})]},b))}return Object(n.jsx)("div",{children:Object(n.jsxs)(f.g,{children:[Object(n.jsx)(f.h,{children:Object(n.jsxs)(f.M,{children:[Object(n.jsx)(f.l,{xs:"6",xl:"6",className:"card_width scrollable max_height",children:Object(n.jsxs)(f.g,{children:[Object(n.jsx)(f.k,{className:"green_text card_width",children:"They owe you"}),Object(n.jsx)(f.h,{className:"card_body_items_width",children:Object(n.jsx)(f.J,{children:e})})]})}),Object(n.jsx)(f.l,{xs:"6",xl:"6",className:"card_width scrollable max_height",children:Object(n.jsxs)(f.g,{children:[Object(n.jsx)(f.k,{className:"red_text card_width",children:"You owe them"}),Object(n.jsx)(f.h,{className:"card_body_items_width",children:Object(n.jsx)(f.J,{children:t})})]})})]})}),Object(n.jsxs)(f.i,{className:"footer_contract_list_element",style:{textAlign:"center"},children:[Object(n.jsx)(f.e,{size:"sm",color:"dark",className:"buttons_inside_contract_list ",disabled:!this.state.isCreditorSelected||!this.state.isDebtorSelected,onClick:this.handleOpenRotationSelectAmount,children:"continue"}),Object(n.jsx)(g.a,{open:this.state.openRotationSelectAmount,onClose:this.handleCloseRotationSelectAmount,"aria-labelledby":"form-dialog-title",children:Object(n.jsx)(C.a,{children:Object(n.jsx)(A,{selectedDebtor:this.state.peopleOweToUser[this.state.selectedDebtor],selectedCreditor:this.state.peopleUserOwesTo[this.state.selectedCreditor],mediatorAddress:this.props.address,profile:this.props.profile,handleClose:this.handleCloseRotationSelectAmount})})})]})]})})}}]),s}(d.Component),v=function(e){Object(c.a)(s,e);var t=Object(i.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).state={},n}return Object(a.a)(s,[{key:"render",value:function(){return console.log(this),Object(n.jsxs)("div",{children:[Object(n.jsx)(S,Object(r.a)({},this.props))," "]})}}]),s}(d.Component);t.default=v}}]);
//# sourceMappingURL=11.678cdbae.chunk.js.map