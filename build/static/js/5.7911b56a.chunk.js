(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[5],{824:function(e,t,n){"use strict";n.r(t),n.d(t,"Dashboard",(function(){return C}));var s=n(20),r=n(380),c=n(652),a=n.n(c),i=n(730),o=n(161),d=n(162),l=n(381),u=n(164),h=n(163),j=n(1),b=n(731),m=n(821),x=n(623),O=n(632),f="0xC3E4e88A37A5Cfd425E8aAb987b2e4F789De639d",p="0xe5CC286DeB70167dab81c776e1f7cDfaDA43F8ca",v=n(822),g=new b.a.eth.Contract(m.a,f),C=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(o.a)(this,n),(s=t.call(this,e)).addFriendFormSubmit=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(e){var t=new b.a.BatchRequest;e.map((function(e){return new Promise((function(s,r){var c=e.request({from:n[0],gas:"1000000"},(function(e,t){e?r(e):s(t)}));t.add(c)}))})),t.execute()},t.preventDefault(),e.next=4,b.a.eth.getAccounts();case 4:n=e.sent,r=new b.a.eth.Contract(m.a,s.state.friendsAddress),c([g.methods.addFriendRequest(s.state.friendsAddress).send,r.methods.addFriendRequestNotRestricted("0xC3E4e88A37A5Cfd425E8aAb987b2e4F789De639d").send]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onCheckMyFriends=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=s,e.next=3,g.methods.getFriends().call();case 3:e.t1=e.sent,e.t2={friendsList:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}}),e)}))),s.onRemoveFriendsList=Object(i.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(e){var n=new b.a.BatchRequest;console.log(t[0]),e.map((function(e){return new Promise((function(s,r){var c=e.request({from:t[0],gas:"1000000"},(function(e,t){e?r(e):s(t)}));n.add(c)}))})),n.execute()},console.log("in onRemoveFriendsList"),e.next=4,b.a.eth.getAccounts();case 4:t=e.sent,n=new b.a.eth.Contract(m.a,s.state.friendsAddress),r([g.methods.removeAllFriends().send,n.methods.removeAllFriends().send]);case 7:case"end":return e.stop()}}),e)}))),s.onSubmitAddDebtRequest=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(e){var t=new b.a.BatchRequest;e.map((function(e){return new Promise((function(s,r){var c=e.request({from:n[0],gas:"1000000"},(function(e,t){e?r(e):s(t)}));t.add(c)}))})),t.execute()},t.preventDefault(),e.next=4,b.a.eth.getAccounts();case 4:n=e.sent,r=new b.a.eth.Contract(m.a,s.state.playerTwo),c([g.methods.addDebtRequest(s.state.playerTwo,s.state.playerOne,s.state.providedAmount,s.state.playerTwo).send,r.methods.addDebtRequestNotRestricted(s.state.playerOne,s.state.playerOne,s.state.providedAmount,s.state.playerTwo).send]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onSubmitConfirmDebtRequest=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,c,i,o,d,l,u,h,j,x,O,f,p,C;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C=function(e){var t=new b.a.BatchRequest;e.map((function(e){return new Promise((function(s,r){var c=e.request({from:n[0],gas:"2000000"},(function(e,t){e?r(e):s(t)}));t.add(c)}))})),t.execute()},t.preventDefault(),e.next=4,b.a.eth.getAccounts();case 4:return n=e.sent,e.next=7,g.methods.getAllExchanges().call();case 7:return r=e.sent,c=r[0],s.setState({playerTwo:c.transaction.from}),s.setState({playerOne:c.transaction.to}),s.setState({providedAmount:c.transaction.amount}),e.next=14,g.methods.getContracts().call();case 14:i=e.sent,l=!1,u=0;case 17:if(!(u<i.length)){e.next=33;break}return e.next=20,new b.a.eth.Contract(JSON.parse(v.interface),o=i[u]);case 20:return h=e.sent,e.next=23,h.methods.getCurrentDebt().call();case 23:if(j=e.sent,!(x=[s.state.playerOne,s.state.playerTwo]).includes(String(j.debtor))||!x.includes(String(j.creditor))){e.next=30;break}return e.next=28,h.methods.addTransaction(s.state.playerOne,s.state.providedAmount,s.state.playerTwo).send({from:n[0],gas:"2000000"});case 28:return l=!0,e.abrupt("break",33);case 30:u++,e.next=17;break;case 33:if(l){e.next=40;break}return e.next=36,g.methods.createBinaryContract(s.state.playerOne,s.state.providedAmount,s.state.playerTwo).send({from:n[0],gas:"4000000"});case 36:return console.log("Binary contract was created successfully!"),e.next=39,g.methods.getLastContract().call();case 39:d=e.sent;case 40:return O=l?o:d,e.next=43,new b.a.eth.Contract(JSON.parse(v.interface),O);case 43:if(e.sent,f=new b.a.eth.Contract(m.a,s.state.playerTwo),!l){e.next=51;break}return e.next=48,g.methods.getZeroAddress().call();case 48:e.t0=e.sent,e.next=52;break;case 51:e.t0=d;case 52:p=e.t0,C([g.methods.confirmDebtRequest(0).send,f.methods.confirmDebtRequestNotRestricted(0,p).send]);case 54:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onCheckMyExchanges=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("your exchanges are:"),e.next=3,g.methods.getAllExchanges().call();case 3:if(e.t0=e.sent[0],e.t1=void 0,e.t0===e.t1){e.next=24;break}return e.t2=console,e.next=9,g.methods.getAllExchanges().call();case 9:return e.t3=e.sent[0],e.t2.log.call(e.t2,e.t3),{},e.t5=Promise,e.next=15,g.methods.getAllExchanges().call();case 15:return e.t6=e.sent[0].transaction,e.t4=e.t5.resolve.call(e.t5,e.t6),e.t7=s,e.next=20,g.methods.getAllExchanges().call();case 20:e.t8=e.sent[0].transaction,e.t9={exchanges:e.t8},e.t10=e.t7.setState.call(e.t7,e.t9),e.t4.then.call(e.t4,e.t10);case 24:case"end":return e.stop()}}),e)}))),s.onCheckMyContracts=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=s,e.next=3,g.methods.getContracts().call();case 3:e.t1=e.sent,e.t2={contractsList:e.t1},e.t0.setState.call(e.t0,e.t2),console.log(s.state.exchanges);case 7:case"end":return e.stop()}}),e)}))),s.onRemoveExchangesList=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(e){var t=new b.a.BatchRequest;e.map((function(e){return new Promise((function(s,r){var c=e.request({from:n[0],gas:"2000000"},(function(e,t){e?r(e):s(t)}));t.add(c)}))})),t.execute()},t.preventDefault(),e.next=4,b.a.eth.getAccounts();case 4:n=e.sent,r=new b.a.eth.Contract(m.a,s.state.playerTwo),c([g.methods.removeAllExchanges().send,r.methods.removeAllExchanges().send]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onRemoveContractsList=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(e){var t=new b.a.BatchRequest;e.map((function(e){return new Promise((function(s,r){var c=e.request({from:n[0],gas:"2000000"},(function(e,t){e?r(e):s(t)}));t.add(c)}))})),t.execute()},t.preventDefault(),e.next=4,b.a.eth.getAccounts();case 4:n=e.sent,r=new b.a.eth.Contract(m.a,s.state.playerTwo),c([g.methods.removeContracts().send,r.methods.removeContracts().send]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.state={friendsAddress:p,friendRequestIndex:"",playerOne:f,providedAmount:"",playerTwo:p,friendsList:[],exchanges:{},contractsList:[]},s.onChangeFormInput=s.onChangeFormInput.bind(Object(l.a)(s)),s.addFriendFormSubmit=s.addFriendFormSubmit.bind(Object(l.a)(s)),s.onSubmitConfirmFriendRequest=s.onSubmitConfirmFriendRequest.bind(Object(l.a)(s)),s.onCheckMyFriends=s.onCheckMyFriends.bind(Object(l.a)(s)),s.onRemoveFriendsList=s.onRemoveFriendsList.bind(Object(l.a)(s)),s.updateRemovedFriends=s.updateRemovedFriends.bind(Object(l.a)(s)),s.onSubmitAddDebtRequest=s.onSubmitAddDebtRequest.bind(Object(l.a)(s)),s.onSubmitConfirmDebtRequest=s.onSubmitConfirmDebtRequest.bind(Object(l.a)(s)),s}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(this.state.friendsList),"undefined"===typeof(t=window.ethereum)){e.next=5;break}return e.next=5,t.enable();case 5:this.onCheckMyExchanges(),this.onCheckMyContracts(),this.onCheckMyFriends();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSubmitConfirmFriendRequest",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,s,r,c,i,o,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=function(e){var t=new b.a.BatchRequest;e.map((function(e){return new Promise((function(s,r){var c=e.request({from:n[0],gas:"1000000"},(function(e,t){e?r(e):s(t)}));t.add(c)}))})),t.execute()},t.preventDefault(),e.next=4,b.a.eth.getAccounts();case 4:return n=e.sent,s=new b.a.eth.Contract(m.a,this.state.friendsAddress),e.next=8,s.methods.getAllExchanges().call();case 8:for(r=e.sent,i=0;i<r.length;i++)"0"===(o=r[i]).exchangePurpose&&o.exchangeDetails.source===this.state.friendsAddress&&(c=i);d([g.methods.confirmFriendRequest(0).send,s.methods.confirmFriendRequestNotRestricted(c).send]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRemovedFriends",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("in remove friends"),e.t0=Promise.resolve(this.onRemoveFriendsList()),e.t1=this,e.next=5,g.methods.getFriends().call();case 5:e.t2=e.sent,e.t3={friendsList:e.t2},e.t4=e.t1.setState.call(e.t1,e.t3),e.t0.then.call(e.t0,e.t4);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onChangeFormInput",value:function(e){e.preventDefault();var t=e.target,n=t.name,s=t.value;this.setState(Object(r.a)({},n,s))}},{key:"render",value:function(){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(x.wb,{children:[Object(s.jsx)(x.u,{xs:"12",md:"4",children:Object(s.jsx)(x.j,{children:Object(s.jsxs)(x.J,{action:"",method:"post",className:"form-horizontal",onSubmit:this.addFriendFormSubmit,children:[Object(s.jsx)(x.n,{children:"Add Friend"}),Object(s.jsx)(x.k,{children:Object(s.jsx)(x.K,{row:!0,children:Object(s.jsx)(x.u,{md:"12",children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.X,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-user"})})}),Object(s.jsx)(x.S,{id:"input1-group1",name:"friendsAddress",placeholder:"Username",value:this.state.friendsAddress,onChange:this.onChangeFormInput})]})})})}),Object(s.jsxs)(x.l,{children:[Object(s.jsxs)(x.f,{type:"submit",size:"sm",color:"success",children:[Object(s.jsx)(O.a,{name:"cil-scrubber"})," Submit"]}),Object(s.jsxs)(x.f,{type:"reset",size:"sm",color:"danger",children:[Object(s.jsx)(O.a,{name:"cil-ban"})," Reset"]})]})]})})}),Object(s.jsx)(x.u,{xs:"12",md:"4",children:Object(s.jsx)(x.j,{children:Object(s.jsxs)(x.J,{action:"",method:"post",className:"form-horizontal",onSubmit:this.onSubmitConfirmFriendRequest,children:[Object(s.jsx)(x.n,{children:"Confirm Friend"}),Object(s.jsx)(x.k,{children:Object(s.jsx)(x.K,{row:!0,children:Object(s.jsx)(x.u,{md:"12",children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.X,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-user"})})}),Object(s.jsx)(x.S,{id:"input2-group2",name:"input2-group2",placeholder:"Confirmation",value:this.state.friendsAddress,onChange:this.onChangeFormInput})]})})})}),Object(s.jsxs)(x.l,{children:[Object(s.jsxs)(x.f,{type:"submit",size:"sm",color:"success",children:[Object(s.jsx)(O.a,{name:"cil-scrubber"})," Submit"]}),Object(s.jsxs)(x.f,{type:"reset",size:"sm",color:"danger",children:[Object(s.jsx)(O.a,{name:"cil-ban"})," Reset"]})]})]})})})]}),Object(s.jsx)(x.wb,{children:Object(s.jsx)(x.u,{xs:"12",md:"6",xl:"6",children:Object(s.jsxs)(x.j,{children:[Object(s.jsx)(x.n,{children:"Friends List"}),Object(s.jsx)(x.k,{children:Object(s.jsx)("div",{className:"table-responsive",children:Object(s.jsxs)("table",{className:"table table-hover table-outline mb-0 ",children:[Object(s.jsx)("thead",{className:"thead-light",children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Friends Address"}),Object(s.jsx)("th",{children:"Friends Name"})]})}),Object(s.jsx)("tbody",{children:this.state.friendsList.map((function(e){return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsx)("div",{children:e})}),Object(s.jsx)("td",{children:Object(s.jsx)("div",{children:"friend name"})})]},e)}))})]})})}),Object(s.jsxs)(x.l,{children:[Object(s.jsxs)(x.f,{type:"button",size:"sm",color:"success",onClick:this.onCheckMyFriends,children:[Object(s.jsx)(O.a,{name:"cil-user"})," Check Friends"]}),Object(s.jsxs)(x.f,{type:"button",size:"sm",color:"danger",onClick:this.updateRemovedFriends,children:[Object(s.jsx)(O.a,{name:"cil-user-unfollow"})," Remove Friends"]})]})]})})}),Object(s.jsxs)(x.wb,{children:[Object(s.jsx)(x.u,{xs:"12",sm:"4",children:Object(s.jsxs)(x.j,{children:[Object(s.jsx)(x.n,{children:"Send Debt Request"}),Object(s.jsx)(x.k,{children:Object(s.jsxs)(x.J,{action:"",method:"post",onSubmit:this.onSubmitAddDebtRequest,children:[Object(s.jsx)(x.K,{children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.S,{id:"fromDebtRequest",name:"playerOne",placeholder:"From",autoComplete:"name",value:this.state.playerOne,onChange:this.onChangeFormInput}),Object(s.jsx)(x.W,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-user"})})})]})}),Object(s.jsx)(x.K,{children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.S,{id:"toDebtRequest",name:"friendsAddress",placeholder:"To",autoComplete:"To",value:this.state.friendsAddress,onChange:this.onChangeFormInput}),Object(s.jsx)(x.W,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-user"})})})]})}),Object(s.jsx)(x.K,{children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.S,{id:"amountDebt",name:"providedAmount",placeholder:"Amount",autoComplete:"amount",onChange:this.onChangeFormInput}),Object(s.jsx)(x.W,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-dollar"})})})]})}),Object(s.jsx)(x.K,{className:"form-actions",children:Object(s.jsx)(x.f,{type:"submit",size:"sm",color:"secondary",children:"Send a Debt Request"})})]})})]})}),Object(s.jsx)(x.u,{xs:"12",sm:"4",children:Object(s.jsxs)(x.j,{children:[Object(s.jsx)(x.n,{children:"Confirm Debt Request"}),Object(s.jsx)(x.k,{children:Object(s.jsxs)(x.J,{action:"",method:"post",onSubmit:this.onSubmitConfirmDebtRequest,children:[Object(s.jsx)(x.K,{children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.S,{id:"fromConfirm",name:"friendsAddress",placeholder:"from",autoComplete:"From",value:this.state.friendsAddress,onChange:this.onChangeFormInput}),Object(s.jsx)(x.W,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-user"})})})]})}),Object(s.jsx)(x.K,{children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.S,{id:"toConfirm",name:"playerOne",placeholder:"To",autoComplete:"to",value:this.state.playerOne,onChange:this.onChangeFormInput}),Object(s.jsx)(x.W,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-user"})})})]})}),Object(s.jsx)(x.K,{children:Object(s.jsxs)(x.V,{children:[Object(s.jsx)(x.S,{id:"amount",name:"providedAmount",placeholder:"Amount",autoComplete:"amount",onChange:this.onChangeFormInput}),Object(s.jsx)(x.W,{children:Object(s.jsx)(x.Y,{children:Object(s.jsx)(O.a,{name:"cil-dollar"})})})]})}),Object(s.jsx)(x.K,{className:"form-actions",children:Object(s.jsx)(x.f,{type:"submit",size:"sm",color:"secondary",children:"Confirm a Debt Request"})})]})})]})})]}),Object(s.jsxs)(x.wb,{children:[Object(s.jsx)(x.u,{xs:"12",md:"4",xl:"4",children:Object(s.jsxs)(x.j,{children:[Object(s.jsx)(x.n,{children:"Contracts"}),Object(s.jsx)(x.k,{children:Object(s.jsx)("div",{className:"table-responsive",children:Object(s.jsxs)("table",{className:"table table-hover table-outline mb-0 ",children:[Object(s.jsx)("thead",{className:"thead-light",children:Object(s.jsx)("tr",{children:Object(s.jsx)("th",{children:"Friends Address"})})}),Object(s.jsx)("tbody",{children:this.state.contractsList.map((function(e){return Object(s.jsx)("tr",{children:Object(s.jsx)("td",{children:Object(s.jsx)("div",{children:e})})},e)}))})]})})}),Object(s.jsxs)(x.l,{children:[Object(s.jsxs)(x.f,{type:"button",size:"sm",color:"success",onClick:this.onCheckMyContracts,children:[Object(s.jsx)(O.a,{name:"cil-user"})," Check Contracts"]}),Object(s.jsxs)(x.f,{type:"button",size:"sm",color:"danger",onClick:this.onRemoveContractsList,children:[Object(s.jsx)(O.a,{name:"cil-user-unfollow"})," Remove Contracts"]})]})]})}),Object(s.jsx)(x.u,{xs:"12",md:"8",xl:"8",children:Object(s.jsxs)(x.j,{children:[Object(s.jsx)(x.n,{children:"Exchanges"}),Object(s.jsx)(x.k,{children:Object(s.jsx)("div",{className:"table-responsive",children:Object(s.jsxs)("table",{className:"table table-hover table-outline mb-0 ",children:[Object(s.jsx)("thead",{className:"thead-light",children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"from Address"}),Object(s.jsx)("th",{children:"to Address"}),Object(s.jsx)("th",{children:"amount"})]})}),Object(s.jsx)("tbody",{children:void 0===this.state.exchanges?Object(s.jsx)("p",{children:"loading.."}):Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsx)("div",{children:this.state.exchanges.from})}),Object(s.jsx)("td",{children:Object(s.jsx)("div",{children:this.state.exchanges.to})}),Object(s.jsx)("td",{children:Object(s.jsx)("div",{children:this.state.exchanges.amount})})]},this.state.exchanges.date)})]})})}),Object(s.jsxs)(x.l,{children:[Object(s.jsxs)(x.f,{type:"button",size:"sm",color:"success",onClick:this.onCheckMyExchanges,children:[Object(s.jsx)(O.a,{name:"cil-user"})," Check Exchanges"]}),Object(s.jsxs)(x.f,{type:"button",size:"sm",color:"danger",onClick:this.onRemoveExchangesList,children:[Object(s.jsx)(O.a,{name:"cil-user-unfollow"})," Remove Exchanges"]})]})]})})]})]})}}]),n}(j.Component);t.default=C}}]);
//# sourceMappingURL=5.7911b56a.chunk.js.map