{"version":3,"sources":["views/pages/register/Register.js","web3.js"],"names":["Register","props","onSubmitRegister","a","console","log","setState","isDeploying","deployAProfileContract","state","username","newContract","deploy","phoneNumber","options","address","location","registerProps","writeUserData","redirect","profileContractName","compiledProfileContract","require","web3","eth","getAccounts","accounts","Contract","JSON","parse","interface","data","bytecode","arguments","send","from","gas","onChangeFormInput","bind","event","preventDefault","target","name","value","this","push","to","className","md","lg","xl","id","type","placeholder","autoComplete","onChange","required","color","block","onClick","Component","window","ethereum","autoRefreshOnNetworkChange"],"mappings":"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","file":"static/js/8.228919a2.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport { Redirect } from \"react-router\";\nimport web3 from \"../../../web3.js\";\nimport {\n  CButton,\n  CCard,\n  CCardBody,\n  CCardFooter,\n  CCol,\n  CContainer,\n  CForm,\n  CInput,\n  CInputGroup,\n  CInputGroupPrepend,\n  CInputGroupText,\n  CRow,\n} from \"@coreui/react\";\nimport CIcon from \"@coreui/icons-react\";\n\nexport class Register extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      username: \"\",\n      phoneNumber: \"\",\n      address: \"\",\n      redirect: false,\n      isDeploying: false,\n    };\n\n    this.onChangeFormInput = this.onChangeFormInput.bind(this);\n    this.onSubmitRegister = this.onSubmitRegister.bind(this);\n    this.deployAProfileContract = this.deployAProfileContract.bind(this);\n    this.deploy = this.deploy.bind(this);\n  }\n\n  onSubmitRegister = async () => {\n    console.log(\"in register\");\n    this.setState({\n      isDeploying: true,\n    });\n    const newContract = await this.deployAProfileContract(this.state.username);\n    console.log(\"deployed\");\n    console.log(newContract);\n    this.setState({\n      isDeploying: false,\n    });\n  };\n\n  deploy = async () => {\n    console.log(this.state.username);\n    const newContract = await this.deployAProfileContract(this.state.username);\n    console.log(\"deployed\");\n    console.log(\"creating user\");\n    console.log(\n      `pn: ${this.state.phoneNumber}, name:${this.state.username}, address:${newContract.options.address}`\n    );\n    await this.props.location.registerProps.writeUserData(\n      this.state.phoneNumber,\n      this.state.username,\n      newContract.options.address\n    );\n    console.log(\"finished\");\n    this.setState({\n      redirect: true,\n    });\n  };\n\n  deployAProfileContract = async (profileContractName) => {\n    const compiledProfileContract = require(\"../../../solidity/build/ProfileContract.json\");\n    console.log(`deploying ${profileContractName}`);\n    const accounts = await web3.eth.getAccounts();\n\n    return await new web3.eth.Contract(\n      JSON.parse(compiledProfileContract.interface)\n    )\n      .deploy({\n        data: compiledProfileContract.bytecode,\n        arguments: [profileContractName],\n      })\n      .send({\n        from: accounts[0],\n        gas: \"4000000\",\n      });\n  };\n\n  onChangeFormInput(event) {\n    event.preventDefault();\n    const {\n      target: { name, value },\n    } = event;\n    this.setState({ [name]: value });\n  }\n  render() {\n    console.log(this);\n    if (this.state.redirect) {\n      return <Redirect push to=\"/\" />;\n    }\n    return (\n      <div className=\"c-app c-default-layout flex-row align-items-center\">\n        <CContainer>\n          <CRow className=\"justify-content-center\">\n            <CCol md=\"9\" lg=\"7\" xl=\"6\">\n              <CCard className=\"mx-4\">\n                <CCardBody className=\"p-4\">\n                  {/* <CForm\n                    // action=\"/register\"\n                    // method=\"post\"\n                    onSubmit={this.deploy}\n                  > */}\n                  <h1>Register</h1>\n                  <p className=\"text-muted\">Create your account</p>\n                  <CInputGroup className=\"mb-3\">\n                    <CInputGroupPrepend>\n                      <CInputGroupText>\n                        <CIcon name=\"cil-user\" />\n                      </CInputGroupText>\n                    </CInputGroupPrepend>\n                    <CInput\n                      id=\"userName\"\n                      name=\"username\"\n                      type=\"text\"\n                      placeholder=\"Username\"\n                      autoComplete=\"off\"\n                      onChange={this.onChangeFormInput}\n                      required\n                    />\n                  </CInputGroup>\n                  <CInputGroup className=\"mb-3\">\n                    <CInputGroupPrepend>\n                      <CInputGroupText>\n                        <CIcon name=\"cil-phone\" />\n                      </CInputGroupText>\n                    </CInputGroupPrepend>\n                    <CInput\n                      id=\"phoneNumber\"\n                      name=\"phoneNumber\"\n                      type=\"text\"\n                      placeholder=\"Phone number\"\n                      autoComplete=\"off\"\n                      onChange={this.onChangeFormInput}\n                      required\n                    />\n                  </CInputGroup>\n                  <CButton\n                    color=\"success\"\n                    block\n                    onClick={this.deploy}\n                    // type=\"submit\"\n                  >\n                    Create Account\n                  </CButton>\n                  <CButton color=\"secondary\" block to=\"/\">\n                    Already have an account?\n                  </CButton>\n                  {/* </CForm> */}\n                </CCardBody>\n              </CCard>\n            </CCol>\n          </CRow>\n          {/* <CRow>\n            <button onClick={this.deploy}>deploy</button>\n          </CRow> */}\n        </CContainer>\n      </div>\n    );\n  }\n}\n\nexport default Register;\n","const Web3 = require('web3');\n\nconst web3 = new Web3(window.ethereum);\n\nwindow.ethereum.autoRefreshOnNetworkChange = false;\n\nexport default web3;"],"sourceRoot":""}